---
title: "Cleveland Indians Game Duration"
subtitle: "Data Exploration"
author: "Michael Foley"
date: "`r Sys.Date()`"
output: 
  html_document:
    css: "style.css"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
```

```{r data}
# Get data from prior step
pew_dat <- readRDS("../data/1_get_data.rds")
```

# Survey Object

Set up a survey object using the **survey** package.

```{r fig.height=3.0, fig.width=3.5, warning=FALSE}
pew_survey <- svydesign(
  ids = ~1,
  weights = ~ weight,
  data = pew_dat_1
)

svytable(~simple_eth + CENIDENTITYb, pew_survey) %>%
  as_tibble() %>% 
  pivot_wider(names_from = CENIDENTITYb, values_from = n) %>%
  adorn_percentages()
```

```{r}
# x <- svyglm(CENIDENTITYb~simple_eth, family=quasibinomial, design = pew_survey, na.action = na.omit) 
# x %>% broom::tidy(exponentiate = TRUE)
# 
# x <- svyby(~CENIDENTITYb, ~simple_eth, pew_survey, svymean, covmat = TRUE)
# vcov(x)
# svycontrast(x, c(-1, 1))
```

